{{h:h|Moderator toc}}
:''This is a technical manual; for the policy, see [[m:CheckUser policy|CheckUser policy]].''

'''[[Special:CheckUser]]''' allows a user with a ''checkuser'' flag to access confidential data stored about a user, [[w:IP address|IP address]], or [[w:CIDR|CIDR]] range. This data includes IP addresses used by a user, all users who edited from an IP address or range, all edits from an IP address or range, [[w:User agent|User agent]] strings, and [[w:X-Forwarded-For|X-Forwarded-For]] headers.

This tool is usually used to counter users creating bad-faith [[w:sock puppet (Internet)|sock puppet accounts]]. (Note: ''checkuser'' may refer to an access to confidential information, a user with permission to do so, or the technical flag.)

==Considerations==
===Wikimedia privacy policy===
Checkusers under the [[w:Wikimedia Foundation|Wikimedia Foundation]] are subject to the [[foundation:privacy policy|privacy policy]] and [[m:CheckUser policy|CheckUser policy]]. Revealing stored confidential data about a user is prohibited unless this is necessary to prevent significant violation of policy or disruption that cannot otherwise be dealt with.

If possible, the checkuser should attempt to resolve the situation ''without'' releasing any information, or by releasing the minimum possible information. The following information is commonly permissible. This list is ''not'' comprehensive, and cannot replace the checkuser's judgment. If the checkuser is at all doubtful, they should give no detail and answer like a [[w:magic 8-ball|magic 8-ball]].
* confirmation that a user is a sockpuppet without noting personal information;
* information released by the user;
* the ISP edited from, if it is large enough that the information is not personally identifiable;
* the country, which is generally not personally identifiable.

The relevant section of the privacy policy states:
<div style="margin:0 1em; border:1px solid #CCC; background:#EEE; font-style:italic;">
It is the policy of Wikimedia that personally identifiable data collected in the server logs, or through records in the database via the CheckUser feature, may be released by the system administrators or users with CheckUser access, in the following situations:
# In response to a valid subpoena or other compulsory request from law enforcement
# With permission of the affected user
# To the chair of Wikimedia Foundation, his/her legal counsel, or his/her designee, when necessary for investigation of abuse complaints.
# Where the information pertains to page views generated by a spider or bot and its dissemination is necessary to illustrate or resolve technical issues.
# Where the user has been vandalising articles or persistently behaving in a disruptive way, data may be released to assist in the targeting of IP blocks, or to assist in the formulation of a complaint to relevant Internet Service Providers
# Where it is reasonably necessary to protect the rights, property or safety of the Wikimedia Foundation, its users or the public.

Wikimedia policy does not permit public distribution of such information under any circumstances, except as described above.
</div>

===Mailing list===
Wikimedia checkusers have access to the private mailing list ''[http://mail.wikipedia.org/mailman/listinfo/checkuser-l checkuser-l]''. They may use this list to discuss or get help, ideas and second opinions.

===Notes===
* CheckUser is not magic wiki [[:en:pixie dust|pixie dust]]. Almost all queries about IPs will be because two editors were ''behaving'' the same way. An editing pattern match is the important thing; the IP match is really just extra evidence (or not).
*Most dialup and a lot of DSL and cable IPs are dynamic. They might change every session, every day, every week, every few months or hardly ever. Unless the access times are right next to each other, be cautious in declaring a match. After a while, you get to know which ISPs change quickly or slowly.
*If it's a proxy, it might not be a match, depending on the size of the organisation running the proxy (per <tt>whois</tt> output). If it's an ISP proxy, it is not so likely to be a match.
*If it's an AOL address, you're out of luck &mdash; AOL sends each ''page request'' through a different proxy.
*If a username is using lots of different IPs in various countries, the IPs may well be open proxies. Check with an open proxy checker.
*Edits from addresses allocated to [[:en:Web hosting|hosting facilities]] ''almost'' always indicates the use of compromised hosting servers to nefarious ends. Note, however, that the user may have a legitimate shell account on the machine.

===Useful tools===
"Unix" here includes [[:en:Unix-like|Unix-like]], [[:en:Linux|Linux]] and [[:en:Mac OS X|Mac OS X]] computers.

* '''[[:en:whois|whois]]:''' On Unix, start a [[:en:terminal emulator|terminal]] and type <code>whois [''IP address'']</code> at the command line. This should tell you who owns the IP, what the range is and may also note what they use it for. On Windows, [http://all-nettools.com/toolbox All Net Tools] has a pretty good web-based whois (which does an nslookup as well).
* '''[[:en:nslookup|nslookup]]:''' On Unix or Windows, <code>nslookup [''IP address'']</code> at the command line will give you the [[:en:FQDN|fully qualified domain name]] associated with the IP. Note that not all IPs have a [[:en:domain name|domain name]], so don't worry if nothing comes back. If you're on Windows, the All Net Tools whois also gives you the FQDN.
* '''[[en:traceroute|traceroute]]:''' With [[:en:IP address|IP]]s from some [[en:Internet service provider|Internet Service Providers]] it may be useful to use the traceroute command and compare the results between two or more IP. The site [http://all-nettools.com/toolbox All Net Tools] also gives you traceroute function if you don't have it as a [[en:Command line interface|command line]].
** '''tcptraceroute:''' A version of traceroute that uses [[en:Transmission Control Protocol|TCP]] packets, which get through some firewalls and packet filters that stop [[en:Internet Control Message Protocol|ICMP]] packets. Source code for Unix-like systems is [http://michael.toren.net/code/tcptraceroute/ here]; most Linux distributions have a package available with it.
* '''Open proxy checking:''' David has yet to find a good tool for this. (<tt>proxycheck</tt> doesn't do what I want.) There are a number of online proxy checkers: [http://www.checker.freeproxy.ru/checker/], [[w:nmap]]. (I have not tried them.) Help needed. I usually work on a combination of online proxy list checking and educated guesswork ;-)  [[:en:User:Tawker]] runs a web-based proxy checker.  To request access to it, contact him on [[:en:User:Tawker|his talk page]].
* '''Checks for other abuse of an IP:''' http://www.rbls.org/ gives the status of any IP address on a number of [[:en:DNSBL|Realtime Blackhole Lists]]. Note that some RBL blocks should be expected, ''e.g.'' many block home dynamic IPs for [[:en:SMTP|SMTP]], but that's not a problem for a wiki. If a user only uses open proxies or addresses marked as sources of abuse, your suspicions may be raised.

==Usage==
{{mirror|[[mw:Extension:CheckUser]]}}

===Basic interface===
# Go to [[Special:CheckUser]].
# In the ''user'' field, type in the username (without the 'user:' prefix), IP address, or CIDR range.
#* IP: any IPv4 or IPv6 address.
#* CIDR: you can check a range of IP addresses by appending the CIDR prefix (up to /16 for IPv4 or /64 for IPv6, or 65,536 addresses). For notation, see [[m:Range blocks|Range blocks]].
#* XFF: you can check an IP address provided by X-Forwarded-For headers by appending ''/xff'' (for example, ''127.0.0.1/xff'').
# Select the information you want to retrieve.
#* ''Get IPs'': returns IP addresses used by a registered user.
#* ''Get edits from IP:'' returns all edits made by a user (registered or anonymous) from an IP address or range.
#* ''Get users'': returns user accounts that have edited from an IP or range.
# In the ''reason'' field, type in the reason you are accessing the confidential data. Try to succinctly summarise the situation (for example, "cross-wiki spam"); this will be logged and may be needed by the [[m:Ombudsman commission|Ombudsman commission]].

<gallery caption="Screenshots">
Image:CheckUser1.png|CheckUser interface
Image:CheckUser2.png|IP check, exemplary results 
Image:CheckUser3.png|Username check, exemplary results
Image:CUlog.JPG|Log
</gallery>

===Information returned===
A typical entry in the checkuser results for a user summary ("get users") is as follows:
<div style="margin:0 1em; border:1px solid #CCC; background:#EEE; font-style:italic;">
* [[user:Example|Example]] ([[user talk:Example|Talk]] | [[Special:Contributions|contribs]]) (20:11, {{#time:d F Y|-1 day}} -- 20:12, {{#time:d F Y|-1 day}}) '''[5]'''
*# 127.0.0.37 '''XFF''': 127.0.0.1, 127.0.0.5<br />''Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.0.11) Gecko/20070312 Firefox/1.5.0.11''
</div>

This is formatted to fit a lot of information into a format that can very easily be listed and skimmed, but is difficult to read unless you know what the information provided is. The information is laid out as follows:
<div style="margin:0 1em; border:1px solid #CCC; background:#EEE; font-style:italic;">
* username (user links) (time period when they edited from the given IP or range) '''[number of edits from the IP or range]'''
*# IP address edited from '''XFF''': XFF information provided (can be spoofed)<br />''user agent: browser, operating system, system language, and versions''
</div>

Each IP/XFF combination used to edit is listed, in order of use. The user agent data for the last corresponding usage each of those edits is listed below.

==How it works==

CheckUser checks against the recentchanges table. This means you can only query data as far back as recentchanges goes. (On Wikimedia wikis, this is nominally a week to a month, though it may be more if the database administrators want to keep more data and have room for it.)

The username check is a fairly intensive query, and if the database is under heavy load it may time out before returning. The IP check is much faster.

The source code is at http://svn.wikimedia.org/viewvc/mediawiki/trunk/extensions/CheckUser/

==Installation==
See [[mw:Extension:CheckUser]].

{{H:f|langs=|enname=CheckUser}}
[[Category:Imported help]]
